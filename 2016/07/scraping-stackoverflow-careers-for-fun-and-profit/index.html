
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Scraping Stackoverflow Careers for Fun and Profit - littlebigtomatoes</title>
  <meta name="author" content="Krisztian Gyuris">

  
  <meta name="description" content="When you want to learn something new the best way to do is to come up with a problem that can be useful to you or maybe others and then solve it. Not &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.littlebigtomatoes.com/2016/07/scraping-stackoverflow-careers-for-fun-and-profit">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/Littlebigtomatoes" rel="alternate" title="littlebigtomatoes" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-55456-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">littlebigtomatoes</a></h1>
  
    <h2>Design.Create.Smile.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/Littlebigtomatoes" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.littlebigtomatoes.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Scraping Stackoverflow Careers for Fun and Profit</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-12T07:55:13+02:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>7:55 am</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://www.littlebigtomatoes.com">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>When you want to learn something new the best way to do is to come up with a problem that can be useful to you or maybe others and then solve it. Not so long ago I decided that I want to start learning data related tech. So I came up with the idea that I would create a solution that gathers the data from <a href="http://stackoverflow.com/jobs">Stackoverflow Jobs</a>. Do some manipulation on it  and then present it in a nice format. This is the first step of the journey.</p>

<p>To present something, I need data. To get the data I need to write a script that gathers it from the web. I decided to use python and <a href="http://scrapy.org">Scrapy framework</a>.</p>

<!--more-->


<p></p>

<h3>Gearing up…</h3>

<p>First, some disclaimers. I am new to python, to scrape. I had zero knowledge of this topics. Any constructive and helpful comments are more than welcome. I am here to learn as well.</p>

<p>After installing python and <a href="http://scrapy.org">Scrapy</a>, the first thing is to create the web-scraper project by typing the following  command(s) in your console</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'> scrapy startproject stackjobs
</span><span class='line'>  <span class="nb">cd </span>stackjobs
</span><span class='line'>  scrapy genspider Stackjob stackoverflow.com
</span></code></pre></td></tr></table></div></figure>


<p>With these commands the following has been achieved. First we create a new project called stack jobs. The script created a folder structure with files in it. Then we entered the folder and created a spider called StackjobSpider using the genspider command. This created a spider that can only crawl stackoverflow.com.</p>

<p>Looking at the spiders folder, we can see the source file for Stackjob spider:</p>

<figure class='code'><figcaption><span>initial spider </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>   <span class="c"># -*- coding: utf-8 -*-</span>
</span><span class='line'>  <span class="kn">import</span> <span class="nn">scrapy</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">class</span> <span class="nc">StackjobSpider</span><span class="p">(</span><span class="n">scrapy</span><span class="o">.</span><span class="n">Spider</span><span class="p">):</span>
</span><span class='line'>      <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Stackjob&quot;</span>
</span><span class='line'>      <span class="n">allowed_domains</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;stackoverflow.com&quot;</span><span class="p">]</span>
</span><span class='line'>      <span class="n">start_urls</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>        <span class="s">&#39;http://www.stackoverflow.com/&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span class='line'>              <span class="k">pass</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>You can running this by executing the following command:</p>

<figure class='code'><figcaption><span>running the spider </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>scrapy crawl Stackjob
</span></code></pre></td></tr></table></div></figure>


<p>This outputs a bunch of stuff that we are not interested in really.</p>

<figure class='code'><figcaption><span>bunch of stuff we are not really interested in</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Scrapy 1.1.0 started <span class="o">(</span>bot: stackjobs<span class="o">)</span>
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Overridden settings: <span class="o">{</span><span class="s1">&#39;NEWSPIDER_MODULE&#39;</span>: <span class="s1">&#39;stackjobs.spiders&#39;</span>, <span class="s1">&#39;SPIDER_MODULES&#39;</span>: <span class="o">[</span><span class="s1">&#39;stackjobs.spiders&#39;</span><span class="o">]</span>, <span class="s1">&#39;ROBOTSTXT_OBEY&#39;</span>: True, <span class="s1">&#39;BOT_NAME&#39;</span>: <span class="s1">&#39;stackjobs&#39;</span><span class="o">}</span>
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Enabled extensions:
</span><span class='line'><span class="o">[</span><span class="s1">&#39;scrapy.extensions.logstats.LogStats&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.extensions.telnet.TelnetConsole&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.extensions.corestats.CoreStats&#39;</span><span class="o">]</span>
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Enabled downloader middlewares:
</span><span class='line'><span class="o">[</span><span class="s1">&#39;scrapy.downloadermiddlewares.robotstxt.RobotsTxtMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.useragent.UserAgentMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.retry.RetryMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.redirect.RedirectMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.cookies.CookiesMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.chunked.ChunkedTransferMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.downloadermiddlewares.stats.DownloaderStats&#39;</span><span class="o">]</span>
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Enabled spider middlewares:
</span><span class='line'><span class="o">[</span><span class="s1">&#39;scrapy.spidermiddlewares.httperror.HttpErrorMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.spidermiddlewares.offsite.OffsiteMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.spidermiddlewares.referer.RefererMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.spidermiddlewares.urllength.UrlLengthMiddleware&#39;</span>,
</span><span class='line'> <span class="s1">&#39;scrapy.spidermiddlewares.depth.DepthMiddleware&#39;</span><span class="o">]</span>
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Enabled item pipelines:
</span><span class='line'><span class="o">[]</span>
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Spider opened
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Crawled <span class="m">0</span> pages <span class="o">(</span>at <span class="m">0</span> pages/min<span class="o">)</span>, scraped <span class="m">0</span> items <span class="o">(</span>at <span class="m">0</span> items/min<span class="o">)</span>
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Telnet console listening on 127.0.0.1:6023
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Redirecting <span class="o">(</span>301<span class="o">)</span> to &lt;GET http://stackoverflow.com/robots.txt&gt; from &lt;GET http://www.stackoverflow.com/robots.txt&gt;
</span><span class='line'>2016-07-11 22:22:30 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Crawled <span class="o">(</span>200<span class="o">)</span> &lt;GET http://stackoverflow.com/robots.txt&gt; <span class="o">(</span>referer: None<span class="o">)</span>
</span><span class='line'>2016-07-11 22:22:31 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Redirecting <span class="o">(</span>301<span class="o">)</span> to &lt;GET http://stackoverflow.com/&gt; from &lt;GET http://www.stackoverflow.com/&gt;
</span><span class='line'>2016-07-11 22:22:31 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Crawled <span class="o">(</span>200<span class="o">)</span> &lt;GET http://stackoverflow.com/robots.txt&gt; <span class="o">(</span>referer: None<span class="o">)</span>
</span><span class='line'>2016-07-11 22:22:31 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Crawled <span class="o">(</span>200<span class="o">)</span> &lt;GET http://stackoverflow.com/&gt; <span class="o">(</span>referer: None<span class="o">)</span>
</span><span class='line'>2016-07-11 22:22:31 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Closing spider <span class="o">(</span>finished<span class="o">)</span>
</span><span class='line'>2016-07-11 22:22:31 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Dumping Scrapy stats:
</span><span class='line'><span class="o">{</span><span class="s1">&#39;downloader/request_bytes&#39;</span>: 1317,
</span><span class='line'> <span class="s1">&#39;downloader/request_count&#39;</span>: 5,
</span><span class='line'> <span class="s1">&#39;downloader/request_method_count/GET&#39;</span>: 5,
</span><span class='line'> <span class="s1">&#39;downloader/response_bytes&#39;</span>: 43377,
</span><span class='line'> <span class="s1">&#39;downloader/response_count&#39;</span>: 5,
</span><span class='line'> <span class="s1">&#39;downloader/response_status_count/200&#39;</span>: 3,
</span><span class='line'> <span class="s1">&#39;downloader/response_status_count/301&#39;</span>: 2,
</span><span class='line'> <span class="s1">&#39;finish_reason&#39;</span>: <span class="s1">&#39;finished&#39;</span>,
</span><span class='line'> <span class="s1">&#39;finish_time&#39;</span>: datetime.datetime<span class="o">(</span>2016, 7, 11, 20, 22, 31, 575630<span class="o">)</span>,
</span><span class='line'> <span class="s1">&#39;log_count/DEBUG&#39;</span>: 6,
</span><span class='line'> <span class="s1">&#39;log_count/INFO&#39;</span>: 7,
</span><span class='line'> <span class="s1">&#39;response_received_count&#39;</span>: 3,
</span><span class='line'> <span class="s1">&#39;scheduler/dequeued&#39;</span>: 2,
</span><span class='line'> <span class="s1">&#39;scheduler/dequeued/memory&#39;</span>: 2,
</span><span class='line'> <span class="s1">&#39;scheduler/enqueued&#39;</span>: 2,
</span><span class='line'> <span class="s1">&#39;scheduler/enqueued/memory&#39;</span>: 2,
</span><span class='line'> <span class="s1">&#39;start_time&#39;</span>: datetime.datetime<span class="o">(</span>2016, 7, 11, 20, 22, 30, 508215<span class="o">)}</span>
</span><span class='line'>2016-07-11 22:22:31 <span class="o">[</span>scrapy<span class="o">]</span> INFO: Spider closed <span class="o">(</span>finished<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This basically tells us that our spider ran and downloaded the stackoverflow.com main page. We are interested only the Stackoverflow job listing, so let’s modify the Stackjob spider, so it crawls only those relevant pages for us. Let’s modify the start_urls in our spider class and add a few pages:</p>

<figure class='code'><figcaption><span>adding start urls </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">class</span> <span class="nc">StackjobSpider</span><span class="p">(</span><span class="n">scrapy</span><span class="o">.</span><span class="n">Spider</span><span class="p">):</span>
</span><span class='line'>    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Stackjob&quot;</span>
</span><span class='line'>    <span class="n">allowed_domains</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;stackoverflow.com&quot;</span><span class="p">]</span>
</span><span class='line'>    <span class="n">start_urls</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>        <span class="s">&#39;https://stackoverflow.com/jobs?sort=p&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;https://stackoverflow.com/jobs?sort=p&amp;pg=2&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;https://stackoverflow.com/jobs?sort=p&amp;pg=3&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;https://stackoverflow.com/jobs?sort=p&amp;pg=4&#39;</span>
</span><span class='line'>    <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span class='line'>        <span class="k">pass</span>
</span></code></pre></td></tr></table></div></figure>


<p>When running the spider again we can find that still nothing really happens. The pages are downloaded, but we do not process the information on the pages. In order to process the information, let’s modify the parse method in our spider.</p>

<p>First we need to add a few imports:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">scrapy</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">datetime</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">StackjobSpider</span><span class="p">(</span><span class="n">scrapy</span><span class="o">.</span><span class="n">Spider</span><span class="p">):</span>
</span><span class='line'>    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Stackjob&quot;</span>
</span><span class='line'>    <span class="n">allowed_domains</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;stackoverflow.com&quot;</span><span class="p">]</span>
</span><span class='line'>    <span class="n">start_urls</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>        <span class="s">&#39;https://stackoverflow.com/jobs?sort=p&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;https://stackoverflow.com/jobs?sort=p&amp;pg=2&#39;</span><span class="p">,</span>
</span><span class='line'>        <span class="s">&#39;https://stackoverflow.com/jobs?sort=p&amp;pg=3&#39;</span>
</span><span class='line'>    <span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then add some code to the <em>parse</em> method. This code will loop through all the jobs on the page and will create a <em>StackjobItem</em> for each job found. Then it will add today’s date to the newly created item.</p>

<figure class='code'><figcaption><span>adding parsing logic </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span class='line'>    <span class="n">jobs</span> <span class="o">=</span> <span class="n">scrapy</span><span class="o">.</span><span class="n">Selector</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;//div[contains(@class, &quot;-item&quot;) and contains(@class, &quot;-job&quot;)]&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">t</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
</span><span class='line'>        <span class="n">item</span> <span class="o">=</span> <span class="n">StackjobItem</span><span class="p">()</span>
</span><span class='line'>                  <span class="n">item</span><span class="p">[</span><span class="s">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>       
</span><span class='line'>
</span><span class='line'>                  <span class="c"># actual parsing will come here </span>
</span><span class='line'>
</span><span class='line'>        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">results</span>
</span></code></pre></td></tr></table></div></figure>


<p>When running this code, you will receive a couple of messages complaining about StackjobItem not being defined. This is expected as we still need to define this class. Open up <em>items.py</em> and rename the class <em>StackjobsItem</em> to <em>StackjobItem</em>. This is the class what we will use to store the extracted data for each job. For this you will need to define a few fields. The final class will look like this:</p>

<figure class='code'><figcaption><span>StackjobItem with fields</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">scrapy</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">scrapy.item</span> <span class="kn">import</span> <span class="n">Item</span><span class="p">,</span> <span class="n">Field</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">StackjobItem</span><span class="p">(</span><span class="n">scrapy</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
</span><span class='line'>    <span class="c"># define the fields for your item here like:</span>
</span><span class='line'>    <span class="c"># name = scrapy.Field()</span>
</span><span class='line'>    <span class="n">title</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">url</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">jobid</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">employer</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">description</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">location</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">equity</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">salary</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">tags</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="n">date</span> <span class="o">=</span> <span class="n">Field</span><span class="p">()</span>
</span><span class='line'>    <span class="k">pass</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, head back to <em>Stackjob.py</em> and import the item class.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">stackjobs.items</span> <span class="kn">import</span> <span class="n">StackjobItem</span>
</span></code></pre></td></tr></table></div></figure>


<p>When running the spider, you should see something like this in the output:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>2016-07-12 07:07:17 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Scraped from &lt;<span class="m">200</span> https://stackoverflow.com/jobs?sort<span class="o">=</span>p<span class="p">&amp;</span><span class="nv">pg</span><span class="o">=</span>3&gt;
</span><span class='line'><span class="o">{</span><span class="s1">&#39;date&#39;</span>: <span class="s1">&#39;2016-07-12&#39;</span><span class="o">}</span>
</span><span class='line'>2016-07-12 07:07:17 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Scraped from &lt;<span class="m">200</span> https://stackoverflow.com/jobs?sort<span class="o">=</span>p<span class="p">&amp;</span><span class="nv">pg</span><span class="o">=</span>3&gt;
</span><span class='line'><span class="o">{</span><span class="s1">&#39;date&#39;</span>: <span class="s1">&#39;2016-07-12&#39;</span><span class="o">}</span>
</span><span class='line'>2016-07-12 07:07:17 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Scraped from &lt;<span class="m">200</span> https://stackoverflow.com/jobs?sort<span class="o">=</span>p<span class="p">&amp;</span><span class="nv">pg</span><span class="o">=</span>3&gt;
</span><span class='line'><span class="o">{</span><span class="s1">&#39;date&#39;</span>: <span class="s1">&#39;2016-07-12&#39;</span><span class="o">}</span>
</span><span class='line'>2016-07-12 07:07:17 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Scraped from &lt;<span class="m">200</span> https://stackoverflow.com/jobs?sort<span class="o">=</span>p<span class="p">&amp;</span><span class="nv">pg</span><span class="o">=</span>3&gt;
</span><span class='line'><span class="o">{</span><span class="s1">&#39;date&#39;</span>: <span class="s1">&#39;2016-07-12&#39;</span><span class="o">}</span>
</span><span class='line'>2016-07-12 07:07:17 <span class="o">[</span>scrapy<span class="o">]</span> DEBUG: Scraped from &lt;<span class="m">200</span> https://stackoverflow.com/jobs?sort<span class="o">=</span>p<span class="p">&amp;</span><span class="nv">pg</span><span class="o">=</span>3&gt;
</span><span class='line'><span class="o">{</span><span class="s1">&#39;date&#39;</span>: <span class="s1">&#39;2016-07-12&#39;</span><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, this tells us that the items are being generated and each item has one field only and that is the <em>date</em> field. This is not really useful, so let’s add more information.</p>

<h3>To the actual scraping</h3>

<p>For getting information out of the items found on the page, we will be using xpath expressions. Earlier, we added one to our parse method. This selector is responsible to find all the jobs on our page. It basically tells scrapy to return all elements that are a div and has both a <em>-job</em> and <em>-item</em> css class.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'> <span class="n">jobs</span> <span class="o">=</span> <span class="n">Selector</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;//div[contains(@class, &quot;-item&quot;) and contains(@class, &quot;-job&quot;)]&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next, we will enumerate through the collection returned in the <em>jobs</em> variable and extract some more information from each item and store it.</p>

<p>In the <em>parse</em> method of our spider, just below the date field add the following lines:</p>

<figure class='code'><figcaption><span>xpaths and css selectors</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">item</span><span class="p">[</span><span class="s">&#39;tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;tags&quot;)]/p/a/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
</span><span class='line'>        <span class="n">item</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;p[contains(@class,&quot;text&quot;) and contains(@class, &quot;description&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>        <span class="n">item</span><span class="p">[</span><span class="s">&#39;location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;ul[contains(@class, &quot;metadata&quot;) and contains(@class, &quot;primary&quot;)]/li[contains(@class, &quot;location&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span class='line'>        <span class="n">item</span><span class="p">[</span><span class="s">&#39;employer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;ul[contains(@class, &quot;metadata&quot;) and contains(@class, &quot;primary&quot;)]/li[contains(@class, &quot;employer&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span class='line'>        <span class="n">item</span><span class="p">[</span><span class="s">&#39;jobid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;@data-jobid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>        <span class="n">item</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/h1/a/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>        <span class="n">item</span><span class="p">[</span><span class="s">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/h1/a/@href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Here, we have an xpath expression for each field that we are interested in. For coming up with the xpath expression I was using Google Chrome and the wonderful <a href="https://www.codeschool.com/courses/discover-devtools">DevTools</a> in it. You can bring this up by opening a web-page and right-cocking on any element and select <em>Inspect</em> from the menu.</p>

<p>The other stuff we need to come up with the expressions is the knowledge of css and lot’s of trial and error. Let’s see a few expressions:</p>

<h3>XPath and CSS munging</h3>

<p>The other stuff we need to come up with the expressions is the knowledge of css and lot’s of trial and error. Let’s see a few expressions:</p>

<figure class='code'><figcaption><span>title and url </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'> <span class="n">item</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/h1/a/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'> <span class="n">item</span><span class="p">[</span><span class="s">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/h1/a/@href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here, we are searching with a div that has the <em>title</em> as a css class and then we need the link <em>a</em> under the <em>h1</em> heading. The text from this link will be store in the <em>title</em> field and the actual link in the <em>url</em> field.</p>

<figure class='code'><figcaption><span>extracting tags</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'> <span class="n">item</span><span class="p">[</span><span class="s">&#39;tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;tags&quot;)]/p/a/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Here, we are looking for a div with a class <em>tags</em> and all the text from the links underneath the paragraph.</p>

<figure class='code'><figcaption><span>extracting the employer</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'> <span class="n">item</span><span class="p">[</span><span class="s">&#39;employer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;ul[contains(@class, &quot;metadata&quot;) and contains(@class, &quot;primary&quot;)]/li[contains(@class, &quot;employer&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Here, we are looking for an unordered list <em>ul</em> with both a class <em>metadata</em> and <em>primary</em> and underneath we are looking for a list item with <em>employer</em> class. We then extract the first item from the returned list and call <em>strip()</em> to get rid of the whitespace characters.</p>

<p>There is one last field that needs to be extracted called <em>salary</em>. This is a bit tricky, because it is not always present.</p>

<figure class='code'><figcaption><span>extracting salary </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title”)]/span[contains(@class,&quot;salary&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">():</span>
</span><span class='line'>    <span class="n">item</span><span class="p">[</span><span class="s">&#39;salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/span[contains(@class,&quot;salary&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>
First, we need to check, if we have an html span tag with class <em>salary</em> our title, if we have then we just extract it and then strip out of the white spaces from the result.</p>

<p>Here is how the full parse method should look like:</p>

<figure class='code'><figcaption><span>final parse method </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
</span><span class='line'>        <span class="n">jobs</span> <span class="o">=</span> <span class="n">Selector</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;//div[contains(@class, &quot;-item&quot;) and contains(@class, &quot;-job&quot;)]&#39;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">t</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
</span><span class='line'>            <span class="n">item</span> <span class="o">=</span> <span class="n">StackjobItem</span><span class="p">()</span>
</span><span class='line'>            <span class="n">item</span><span class="p">[</span><span class="s">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">)</span>
</span><span class='line'>            <span class="n">item</span><span class="p">[</span><span class="s">&#39;tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;tags&quot;)]/p/a/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
</span><span class='line'>            <span class="n">item</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;p[contains(@class,&quot;text&quot;) and contains(@class, &quot;description&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>            <span class="n">item</span><span class="p">[</span><span class="s">&#39;location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;ul[contains(@class, &quot;metadata&quot;) and contains(@class, &quot;primary&quot;)]/li[contains(@class, &quot;location&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span class='line'>            <span class="n">item</span><span class="p">[</span><span class="s">&#39;employer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;ul[contains(@class, &quot;metadata&quot;) and contains(@class, &quot;primary&quot;)]/li[contains(@class, &quot;employer&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span class='line'>            <span class="n">item</span><span class="p">[</span><span class="s">&#39;jobid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;@data-jobid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>            <span class="n">item</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/h1/a/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>            <span class="n">item</span><span class="p">[</span><span class="s">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/h1/a/@href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'>            <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/span[contains(@class,&quot;salary&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">():</span>
</span><span class='line'>                <span class="n">item</span><span class="p">[</span><span class="s">&#39;salary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s">&#39;div[contains(@class,&quot;-title&quot;)]/span[contains(@class,&quot;salary&quot;)]/text()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span class='line'>            <span class="c"># yield item</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">results</span>
</span></code></pre></td></tr></table></div></figure>


<p>After running the parser, we should see the extra fields being added to our item.</p>

<figure class='code'><figcaption><span>output from the parser </span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">{</span><span class="s1">&#39;date&#39;</span>: <span class="s1">&#39;2016-07-12&#39;</span>,
</span><span class='line'> <span class="s1">&#39;description&#39;</span>: u<span class="s1">&#39;COMPANY DESCRIPTION\r\nSAP\u2019s vision is to help the world run better and improve people\u2019s lives.\r\nAs the\u2026&#39;</span>,
</span><span class='line'> <span class="s1">&#39;employer&#39;</span>: u<span class="s1">&#39;SAP SE&#39;</span>,
</span><span class='line'> <span class="s1">&#39;jobid&#39;</span>: u<span class="s1">&#39;106345&#39;</span>,
</span><span class='line'> <span class="s1">&#39;location&#39;</span>: u<span class="s1">&#39;Walldorf, Deutschland&#39;</span>,
</span><span class='line'> <span class="s1">&#39;tags&#39;</span>: <span class="o">[</span>u<span class="s1">&#39;c++&#39;</span>, u<span class="s1">&#39;python&#39;</span>, u<span class="s1">&#39;linux&#39;</span>, u<span class="s1">&#39;git&#39;</span>, u<span class="s1">&#39;shell&#39;</span><span class="o">]</span>,
</span><span class='line'> <span class="s1">&#39;title&#39;</span>: u<span class="s1">&#39;C++ (Senior) Developer for SAP HANA&#39;</span>,
</span><span class='line'> <span class="s1">&#39;url&#39;</span>: u<span class="s1">&#39;/jobs/106345/c-plus-plus-senior-developer-for-sap-hana-sap-se&#39;</span><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is exciting. In the next part, I will show how to store the results in a mongoldb database.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Krisztian Gyuris</span></span>

      




<time class='entry-date' datetime='2016-07-12T07:55:13+02:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>7:55 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/python/'>python</a>, <a class='category' href='/blog/categories/scrapy/'>scrapy</a>, <a class='category' href='/blog/categories/stackoverflow/'>stackoverflow</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.littlebigtomatoes.com/2016/07/scraping-stackoverflow-careers-for-fun-and-profit/" data-via="gyurisc" data-counturl="http://www.littlebigtomatoes.com/2016/07/scraping-stackoverflow-careers-for-fun-and-profit/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2016/06/how-to-generate-typescript-classes-from-c-number-like-a-pro/" title="Previous Post: How to generate Typescript classes from C# like a Pro">&laquo; How to generate Typescript classes from C# like a Pro</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2016/07/scraping-stackoverflow-careers-for-fun-and-profit/">Scraping Stackoverflow Careers for Fun and Profit</a>
      </li>
    
      <li class="post">
        <a href="/2016/06/how-to-generate-typescript-classes-from-c-number-like-a-pro/">How to Generate Typescript Classes From C# Like a Pro</a>
      </li>
    
      <li class="post">
        <a href="/2015/10/serializing-empty-ienumerable-with-protobuf-dot-net/">Serializing Empty IEnumerable<T> With protobuf.net</a>
      </li>
    
      <li class="post">
        <a href="/2014/11/the-problem-with-wirecutter/">The Problem With Wirecutter</a>
      </li>
    
      <li class="post">
        <a href="/2014/10/what-does-the-term-porcelain-mean-in-git/">What Does the Term Porcelain Mean in Git</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/gyurisc">@gyurisc</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'gyurisc',
            count: 4,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $(document).ready(function(){
      getTwitterFeed("gyurisc", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/gyurisc" class="twitter-follow-button" data-show-count="false">Follow @gyurisc</a>
  
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll&#8230;</ul>
  <p><a href="http://pinboard.in/u:gyurisc">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "gyurisc"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Krisztian Gyuris -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'littlebigtomatoes';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.littlebigtomatoes.com/2016/07/scraping-stackoverflow-careers-for-fun-and-profit/';
        var disqus_url = 'http://www.littlebigtomatoes.com/2016/07/scraping-stackoverflow-careers-for-fun-and-profit/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
